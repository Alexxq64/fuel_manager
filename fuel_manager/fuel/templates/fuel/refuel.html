{% extends 'fuel/base.html' %}
{% block title %}–ó–∞–ø—Ä–∞–≤–∫–∞{% endblock %}
{% block content %}

<h2 class="mb-4">–ó–∞–ø—Ä–∞–≤–∫–∞</h2>

<form method="post" novalidate>
    {% csrf_token %}
    {{ form.non_field_errors }}

    <div class="row">
        {% for pump, nozzles in grouped_nozzles %}
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm rounded h-100">
                    <div class="card-header text-center fw-bold bg-primary text-white">
                        {{ pump.name }}
                    </div>
                    <div class="card-body d-grid gap-3">
                        {% for nozzle in nozzles %}
                            {% with fuel_type=nozzle.tank.fuel_type.name %}
                                <input type="radio" class="btn-check" name="nozzle" id="nozzle-{{ nozzle.id }}" value="{{ nozzle.id }}"
                                       {% if form.data.nozzle == nozzle.id|stringformat:"s" %}checked{% endif %}>
                                <label class="btn btn-outline-secondary rounded-pill py-2 shadow-sm fw-semibold"
                                       for="nozzle-{{ nozzle.id }}">
                                    {% if "–¥–∏–∑–µ–ª—å" in fuel_type|lower %}
                                        ‚õΩ –î–∏–∑–µ–ª—å
                                    {% elif "–±–µ–Ω–∑–∏–Ω" in fuel_type|lower %}
                                        üõ¢Ô∏è –ë–µ–Ω–∑–∏–Ω
                                    {% else %}
                                        {{ fuel_type }}
                                    {% endif %}
                                </label>
                            {% endwith %}
                        {% endfor %}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    {% if form.nozzle.errors %}
        <div class="text-danger">{{ form.nozzle.errors }}</div>
    {% endif %}

    <div class="mb-3">
        <label class="form-label" for="{{ form.liters.id_for_label }}">{{ form.liters.label }}</label>
        <input type="number" name="{{ form.liters.name }}" id="{{ form.liters.id_for_label }}"
               class="form-control" step="0.01" min="0.01"
               value="{{ form.liters.value|default_if_none:'' }}">
        {% if form.liters.errors %}
            <div class="text-danger">{{ form.liters.errors }}</div>
        {% endif %}
    </div>

    <div class="mb-3">
        <label class="form-label" for="{{ form.amount.id_for_label }}">{{ form.amount.label }}</label>
        <input type="number" name="{{ form.amount.name }}" id="{{ form.amount.id_for_label }}"
               class="form-control" step="0.01" min="0.01"
               value="{{ form.amount.value|default_if_none:'' }}">
        {% if form.amount.errors %}
            <div class="text-danger">{{ form.amount.errors }}</div>
        {% endif %}
    </div>

    <div class="mb-3">
        <label class="form-label" for="{{ form.client.id_for_label }}">{{ form.client.label }}</label>
        <select name="{{ form.client.name }}" id="{{ form.client.id_for_label }}" class="form-select">
            <option value="">---------</option>
            {% for val, label in form.client.field.choices %}
                <option value="{{ val }}" {% if form.client.value == val %}selected{% endif %}>
                    {{ label }}
                </option>
            {% endfor %}
        </select>
        {% if form.client.errors %}
            <div class="text-danger">{{ form.client.errors }}</div>
        {% endif %}
    </div>

    <button type="submit" class="btn btn-success w-100 py-2 fw-bold">üöó –ó–∞–ø—Ä–∞–≤–∏—Ç—å</button>
</form>

{% endblock %}
